<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>AutoReport</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="../js/jquery-easyui-1.5.2/jquery.min.js"></script>
    <script src="../js/jquery-easyui-1.5.2/jquery.easyui.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../js/jquery-easyui-1.5.2/themes/default/easyui.css" />
    <link rel="stylesheet" href="../js/jquery-easyui-1.5.2/themes/icon.css" />
    <script src="../js/jquery-easyui-1.5.2/locale/easyui-lang-zh_CN.js" type="text/javascript"></script>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <!-- <link rel="stylesheet" href="../css/base.css"> -->
    <link rel="stylesheet" href="../css/common.css">
</head>

<body>
    <div class="wrapper" style="height: auto; min-height: 100%;">
        <!-- 左边导航 -->
        
        <!-- 右边content信息 -->
        <div class="content">
            <div class="col-md-12">
                <div class="box box-warning">
                    <div class="box-header">
                        带翻页的datagrid
                    </div>
                    <div class="box-body">
                        <div class="m-datagrid container">
                            <table id="grid"></table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="box box-danger">
                    <div class="box-header">
                        带冻结及排序效果的datagrid
                    </div>
                    <div class="box-body">
                        <div class="m-datagrid container">
                            <table id="grid-frozen"></table>
                        </div>
                    </div>
                </div>
                <div class="box box-info">
                    <div class="box-header">
                        带编辑和图标的datagrid
                    </div>
                    <div class="box-body">
                        <div class="m-datagrid container">
                            <table id="dg" class="easyui-datagrid" title="Row Editing in DataGrid" style="width:450px;height:auto" data-options="
                iconCls: 'icon-edit',
                singleSelect: true,
                toolbar: '#tb',
                url: '../mockdata/datagrid_data1.json',
                method: 'get',
                onClickCell: onClickCell,
                onEndEdit: onEndEdit
            ">
                                <thead>
                                    <tr>
                                        <th data-options="field:'itemid',width:80">Item ID</th>
                                        <th data-options="field:'productid',width:100,
                        formatter:function(value,row){
                            return row.productname;
                        },
                        editor:{
                            type:'combobox',
                            options:{
                                valueField:'productid',
                                textField:'productname',
                                method:'get',
                                url:'products.json',
                                required:true
                            }
                        }">Product</th>
                                        <th data-options="field:'listprice',width:80,align:'right',editor:{type:'numberbox',options:{precision:1}}">List Price</th>
                                        <th data-options="field:'unitcost',width:80,align:'right',editor:'numberbox'">Unit Cost</th>
                                        <th data-options="field:'attr1',width:250,editor:'textbox'">Attribute</th>
                                        <th data-options="field:'status',width:60,align:'center',editor:{type:'checkbox',options:{on:'P',off:''}}">Status</th>
                                    </tr>
                                </thead>
                            </table>
                            <div id="tb" style="height:auto">
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-add',plain:true" onclick="append()">Append</a>
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-remove',plain:true" onclick="removeit()">Remove</a>
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-save',plain:true" onclick="accept()">Accept</a>
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-undo',plain:true" onclick="reject()">Reject</a>
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-search',plain:true" onclick="getChanges()">GetChanges</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="box box-danger">
                    <div class="box-header">
                        Basic ComboGrid
                    </div>
                    <div class="box-body">
                        <div class="m-datagrid container">
                            <div class="easyui-panel" style="width:100%;max-width:400px;padding:30px 60px;">
                                <div style="margin-bottom:20px">
                                    <select class="easyui-combogrid" style="width:100%" data-options="
                                            panelWidth: 500,
                                            idField: 'itemid',
                                            textField: 'productname',
                                            url: '../mockdata/datagrid_data1.json',
                                            method: 'get',
                                            columns: [[
                                                {field:'itemid',title:'Item ID',width:80},
                                                {field:'productname',title:'Product',width:120},
                                                {field:'listprice',title:'List Price',width:80,align:'right'},
                                                {field:'unitcost',title:'Unit Cost',width:80,align:'right'},
                                                {field:'attr1',title:'Attribute',width:200},
                                                {field:'status',title:'Status',width:60,align:'center'}
                                            ]],
                                            fitColumns: true,
                                            label: 'Select Item:',
                                            labelPosition: 'top'
                                        ">
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box box-success">
                    <div class="box-header">
                        Basic treegrid_(:3ゝ∠)_
                    </div>
                    <div class="box-body">
                        <div class="m-datagrid container">
                            <table title="Folder Browser" class="easyui-treegrid" style="width:450px;height:250px"
            data-options="
                url: '../mockdata/treegrid_data1.json',
                method: 'get',
                rownumbers: true,
                idField: 'id',
                treeField: 'name'
            ">
        <thead>
            <tr>
                <th data-options="field:'name'" width="220">Name</th>
                <th data-options="field:'size'" width="100" align="right">Size</th>
                <th data-options="field:'date'" width="150">Modified Date</th>
            </tr>
        </thead>
    </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</body>
<script src='../components/header/header.js'></script>
<script src='../components/sidebar/sidebar.js'></script>
<script>

   $('.content').headerPlugin();
$('.content').sidebarPlugin({
    defaultIcon:'glyphicon glyphicon-list-alt'
});
</script>
<script>
var oldRowIndex;
//普通datagrid，带翻页
var opt = $("#grid");
$('#grid').datagrid({
    width:1000,
    title: '个人信息数据表',
    iconCls: 'glyphicon glyphicon-user',
    url: '../mockdata/datagrid.json',
    nowrap: false,
    striped: true,
    fitColumns: true,
    singleSelect: true,
    pageSize: 3,
    pageList: [3, 5, 5],
    pagination: true, //是否启用分页  
    rownumbers: true, //是否显示列数 
    onClickRow: function(rowIndex) {
        if (oldRowIndex == rowIndex) {
            opt.datagrid('clearSelections', oldRowIndex);
        }
        var selectRow = opt.datagrid('getSelected');
        oldRowIndex = opt.datagrid('getRowIndex', selectRow);
        console.log(selectRow);
        console.log(oldRowIndex);
        alert("选中了第" + (oldRowIndex + 1) + "行");
    },
    columns: [
        [{
            field: 'Name',
            title: '姓名',
            width: 100
        }, {
            field: 'PassWord',
            title: '密码',
            width: 100
        }, {
            field: 'Sex',
            title: '性别',
            width: 100,
            align: 'right'
        }, {
            field: 'age',
            title: '年龄',
            width: 100,
            align: 'right'
        }, {
            field: 'address',
            title: '地址',
            width: 100,
            align: 'right'
        }]
    ]
}).datagrid("getPager").pagination({
    beforePageText: '第', //页数文本框前显示的汉字    
    afterPageText: '页/{pages}页',
    displayMsg: '共{total}条记录',
    onBeforeRefresh: function() {
        return true;
    }
});

//带冻结，和排序的datagrid
$('#grid-frozen').datagrid({
    width: 450,
    title: '个人信息数据表',
    iconCls: 'glyphicon glyphicon-user',
    url: '../mockdata/datagrid.json',
    remoteSort: false,
    // nowrap: false,  
    striped: true,
    // fitColumns: true,  
    singleSelect: true,

    onClickRow: function(rowIndex) {
        if (oldRowIndex == rowIndex) {
            opt.datagrid('clearSelections', oldRowIndex);
        }
        var selectRow = opt.datagrid('getSelected');
        oldRowIndex = opt.datagrid('getRowIndex', selectRow);
        console.log(selectRow);
        console.log(oldRowIndex);
    },
    columns: [
        [

            {
                field: 'PassWord',
                title: '密码',
                width: 100
            }, {
                field: 'Sex',
                title: '性别',
                width: 100,
                align: 'right'
            }, {
                field: 'age',
                title: '年龄',
                width: 100,
                align: 'right',
                sortable: true,
                sorter: function(a, b) {
                    return (a > b ? 1 : -1);
                }
            }, {
                field: 'address',
                title: '地址',
                width: 100,
                align: 'right'
            }
        ]
    ],

    frozenColumns: [
        [{
            field: 'Name',
            title: '姓名',
            width: 100
        }]
    ]
});

var toolbar = [{
        iconCls: 'icon-edit',
        handler: function() {
            if (endEditing()) {
                $('#grid-toolbar').datagrid('appendRow', {
                    status: 'P'
                });
                editIndex = $('#grid-toolbar').datagrid('getRows').length - 1;
                $('#grid-toolbar').datagrid('selectRow', editIndex)
                    .datagrid('beginEdit', editIndex);
            }
        }
    },
    '-', {
        iconCls: 'icon-help',
        handler: function() {
            alert('help')
        }
    }
];

var editIndex = undefined;

function endEditing() {
    if (editIndex == undefined) {
        return true
    }
    if ($('#dg').datagrid('validateRow', editIndex)) {
        $('#dg').datagrid('endEdit', editIndex);
        editIndex = undefined;
        return true;
    } else {
        return false;
    }
}

function onClickCell(index, field) {
    if (editIndex != index) {
        if (endEditing()) {
            $('#dg').datagrid('selectRow', index)
                .datagrid('beginEdit', index);
            var ed = $('#dg').datagrid('getEditor', {
                index: index,
                field: field
            });
            if (ed) {
                ($(ed.target).data('textbox') ? $(ed.target).textbox('textbox') : $(ed.target)).focus();
            }
            editIndex = index;
        } else {
            setTimeout(function() {
                $('#dg').datagrid('selectRow', editIndex);
            }, 0);
        }
    }
}

function onEndEdit(index, row) {
    var ed = $(this).datagrid('getEditor', {
        index: index,
        field: 'productid'
    });
    row.productname = $(ed.target).combobox('getText');
}

function append() {
    if (endEditing()) {
        $('#dg').datagrid('appendRow', {
            status: 'P'
        });
        editIndex = $('#dg').datagrid('getRows').length - 1;
        $('#dg').datagrid('selectRow', editIndex)
            .datagrid('beginEdit', editIndex);
    }
}

function removeit() {
    if (editIndex == undefined) {
        return
    }
    $('#dg').datagrid('cancelEdit', editIndex)
        .datagrid('deleteRow', editIndex);
    editIndex = undefined;
}

function accept() {
    if (endEditing()) {
        $('#dg').datagrid('acceptChanges');
    }
}

function reject() {
    $('#dg').datagrid('rejectChanges');
    editIndex = undefined;
}

function getChanges() {
    var rows = $('#dg').datagrid('getChanges');
    alert(rows.length + ' rows are changed!');
}
</script>

</html>
